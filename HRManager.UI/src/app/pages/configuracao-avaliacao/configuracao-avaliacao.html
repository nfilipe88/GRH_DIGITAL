<div class="container mx-auto p-8">
  <h1 class="text-3xl font-bold text-gray-800 mb-6">Configurações de Avaliação</h1>

  <div class="flex border-b border-gray-200 mb-6">
    <button (click)="activeTab = 'competencias'"
      class="px-6 py-3 font-medium text-sm focus:outline-none border-b-2 transition-colors"
      [ngClass]="activeTab === 'competencias' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'">
      1. Competências (Perguntas)
    </button>
    <button (click)="activeTab = 'ciclos'"
      class="px-6 py-3 font-medium text-sm focus:outline-none border-b-2 transition-colors"
      [ngClass]="activeTab === 'ciclos' ? 'border-blue-600 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'">
      2. Ciclos de Avaliação
    </button>
  </div>

  <div *ngIf="activeTab === 'competencias'" class="grid grid-cols-1 lg:grid-cols-3 gap-8">

    <div class="lg:col-span-1">
      <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
        <h3 class="text-lg font-bold mb-4 text-gray-700">Nova Competência</h3>

        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">Nome *</label>
            <input type="text" [(ngModel)]="novaCompetencia.nome" placeholder="Ex: Proatividade"
              class="mt-1 w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-blue-500">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">Descrição</label>
            <textarea [(ngModel)]="novaCompetencia.descricao" rows="2" placeholder="O que se espera..."
              class="mt-1 w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-blue-500"></textarea>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">Tipo</label>
            <select [(ngModel)]="novaCompetencia.tipo" class="mt-1 w-full rounded-md border-gray-300 shadow-sm p-2 border">
              <option [ngValue]="0">Comportamental (Soft Skill)</option>
              <option [ngValue]="1">Técnica (Hard Skill)</option>
            </select>
          </div>

          <button (click)="adicionarCompetencia()" [disabled]="loading || !novaCompetencia.nome"
            class="w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 disabled:opacity-50">
            {{ loading ? 'A guardar...' : 'Adicionar Competência' }}
          </button>
        </div>
      </div>
    </div>

    <div class="lg:col-span-2">
      <div class="bg-white rounded-lg shadow-md border border-gray-100 overflow-hidden">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nome</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Tipo</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Estado</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200">
            <tr *ngFor="let c of listaCompetencias">
              <td class="px-6 py-4">
                <div class="font-medium text-gray-900">{{ c.nome }}</div>
                <div class="text-sm text-gray-500">{{ c.descricao }}</div>
              </td>
              <td class="px-6 py-4 text-sm text-gray-500">
                <span [ngClass]="c.tipo === 0 ? 'bg-purple-100 text-purple-800' : 'bg-indigo-100 text-indigo-800'"
                  class="px-2 py-1 rounded-full text-xs font-semibold">
                  {{ c.tipo === 0 ? 'Comportamental' : 'Técnica' }}
                </span>
              </td>
              <td class="px-6 py-4">
                <span class="text-green-600 text-sm font-medium" *ngIf="c.isAtiva">Ativa</span>
                <span class="text-red-500 text-sm font-medium" *ngIf="!c.isAtiva">Inativa</span>
              </td>
            </tr>
            <tr *ngIf="listaCompetencias.length === 0">
              <td colspan="3" class="px-6 py-8 text-center text-gray-500">
                Nenhuma competência registada. Adicione a primeira à esquerda.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div *ngIf="activeTab === 'ciclos'" class="grid grid-cols-1 lg:grid-cols-3 gap-8">

    <div class="lg:col-span-1">
      <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
        <h3 class="text-lg font-bold mb-4 text-gray-700">Novo Ciclo</h3>

        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">Nome do Ciclo *</label>
            <input type="text" [(ngModel)]="novoCiclo.nome" placeholder="Ex: Avaliação Anual 2025"
              class="mt-1 w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-blue-500">
          </div>

          <div class="grid grid-cols-2 gap-2">
            <div>
              <label class="block text-sm font-medium text-gray-700">Início *</label>
              <input type="date" [(ngModel)]="novoCiclo.dataInicio"
                class="mt-1 w-full rounded-md border-gray-300 shadow-sm p-2 border">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">Fim *</label>
              <input type="date" [(ngModel)]="novoCiclo.dataFim"
                class="mt-1 w-full rounded-md border-gray-300 shadow-sm p-2 border">
            </div>
          </div>

          <button (click)="adicionarCiclo()" [disabled]="loading"
            class="w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 disabled:opacity-50">
            {{ loading ? 'A criar...' : 'Criar Ciclo' }}
          </button>
        </div>
      </div>
    </div>

    <div class="lg:col-span-2">
      <div class="bg-white rounded-lg shadow-md border border-gray-100 overflow-hidden">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ciclo</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Período</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Estado</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200">
            <tr *ngFor="let ciclo of listaCiclos">
              <td class="px-6 py-4 font-medium text-gray-900">{{ ciclo.nome }}</td>
              <td class="px-6 py-4 text-sm text-gray-500">
                {{ ciclo.dataInicio | date:'dd/MM/yy' }} - {{ ciclo.dataFim | date:'dd/MM/yy' }}
              </td>
              <td class="px-6 py-4">
                <span [ngClass]="ciclo.isAtivo ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'"
                  class="px-2 py-1 rounded-full text-xs font-semibold">
                  {{ ciclo.isAtivo ? 'Ativo' : 'Fechado' }}
                </span>
              </td>
            </tr>
            <tr *ngIf="listaCiclos.length === 0">
              <td colspan="3" class="px-6 py-8 text-center text-gray-500">
                Nenhum ciclo criado. Crie um para começar as avaliações.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

</div>
