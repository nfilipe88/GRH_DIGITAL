<div class="container mx-auto p-8">

  <div class="flex justify-between items-center mb-6 bg-white p-4 rounded-lg shadow-sm">
    <h1 class="text-2xl font-bold text-gray-800">
      Calendário de Equipa
    </h1>

    <div class="flex items-center gap-4">
      <button (click)="mudarMes(-1)" class="p-2 hover:bg-gray-100 rounded-full">
        &lt; Anterior
      </button>
      <span class="text-lg font-semibold min-w-[150px] text-center">
        {{ dataAtual | date:'MMMM yyyy' }}
      </span>
      <button (click)="mudarMes(1)" class="p-2 hover:bg-gray-100 rounded-full">
        Próximo &gt;
      </button>
    </div>
  </div>

  <div class="bg-white rounded-lg shadow-md overflow-hidden">

    <div class="grid grid-cols-7 border-b border-gray-200 bg-gray-50">
      @for (diaSemana of diasDaSemana; track diaSemana) {
        <div class="py-3 text-center text-sm font-semibold text-gray-600 uppercase tracking-wider">
          {{ diaSemana }}
        </div>
      }
    </div>

    <div class="grid grid-cols-7 auto-rows-fr">

      @for (vazio of diasVaziosInicio; track $index) {
        <div class="h-32 border-b border-r border-gray-100 bg-gray-50/30"></div>
      }

      @for (dia of diasDoMes; track dia) {
        <div class="h-32 border-b border-r border-gray-100 p-2 relative hover:bg-gray-50 transition-colors">

          <span class="text-sm font-medium text-gray-700"
                [ngClass]="{'bg-blue-600 text-white px-2 py-1 rounded-full': dia.toDateString() === (dataAtual | date:'fullDate') ? false : false}">
            {{ dia.getDate() }}
          </span>

          <div class="mt-1 flex flex-col gap-1 overflow-y-auto max-h-[90px]">

            @for (ausencia of getAusenciasDoDia(dia); track ausencia.id) {
              <div class="text-xs p-1 rounded border cursor-pointer truncate"
                   [ngClass]="{
                     'bg-green-100 text-green-800 border-green-200': ausencia.estado === 'Aprovada',
                     'bg-yellow-100 text-yellow-800 border-yellow-200': ausencia.estado === 'Pendente'
                   }"
                   [title]="ausencia.nomeColaborador + ' (' + ausencia.tipo + ')'">
                <strong>{{ ausencia.nomeColaborador }}</strong>
                <span class="hidden sm:inline"> - {{ ausencia.tipo }}</span>
              </div>
            }

          </div>
        </div>
      }

    </div>
  </div>

  <div class="mt-4 flex gap-4 text-sm text-gray-600">
    <div class="flex items-center gap-2">
      <div class="w-3 h-3 bg-yellow-100 border border-yellow-200 rounded"></div>
      <span>Pendente</span>
    </div>
    <div class="flex items-center gap-2">
      <div class="w-3 h-3 bg-green-100 border border-green-200 rounded"></div>
      <span>Aprovada</span>
    </div>
  </div>

</div>
